<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>D√©marrer avec WaziBot ‚Äî Essai gratuit 7 jours</title>
<link href="https://fonts.googleapis.com/css2?family=Clash+Display:wght@600;700&family=Cabinet+Grotesk:wght@300;400;500;700&display=swap" rel="stylesheet">
<style>
  :root { --bg:#f7f3ee;--dark:#1a1208;--accent:#e85c0e;--accent2:#25D366;--text:#2d2010;--muted:#8a7560;--border:#e8ddd0; }
  *{margin:0;padding:0;box-sizing:border-box;}
  body{font-family:'Cabinet Grotesk',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;}
  nav{padding:20px 60px;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid var(--border);background:var(--bg);}
  .logo{font-family:'Clash Display',sans-serif;font-size:22px;font-weight:700;color:var(--dark);text-decoration:none;}
  .logo span{color:var(--accent);}
  .container{max-width:1100px;margin:0 auto;padding:60px 24px;display:grid;grid-template-columns:1fr 1fr;gap:80px;align-items:start;}
  .left .badge{display:inline-flex;align-items:center;gap:8px;background:rgba(37,211,102,0.1);color:var(--accent2);border:1px solid rgba(37,211,102,0.3);padding:6px 14px;border-radius:50px;font-size:13px;font-weight:600;margin-bottom:24px;}
  .left h1{font-family:'Clash Display',sans-serif;font-size:42px;font-weight:700;line-height:1.2;color:var(--dark);margin-bottom:20px;}
  .left h1 em{color:var(--accent);font-style:normal;}
  .left p{color:var(--muted);font-size:16px;line-height:1.7;margin-bottom:36px;}
  .benefits{list-style:none;}
  .benefits li{display:flex;align-items:flex-start;gap:12px;padding:14px 0;border-bottom:1px solid var(--border);font-size:15px;}
  .benefits li:last-child{border-bottom:none;}
  .benefits .icon{width:36px;height:36px;border-radius:10px;background:rgba(232,92,14,0.1);display:flex;align-items:center;justify-content:center;font-size:18px;flex-shrink:0;}
  .benefits .text strong{display:block;font-weight:700;margin-bottom:2px;}
  .benefits .text span{color:var(--muted);font-size:13px;}
  .form-card{background:white;border-radius:24px;padding:40px;border:1px solid var(--border);box-shadow:0 20px 60px rgba(26,18,8,0.08);position:sticky;top:24px;}
  .form-card h2{font-family:'Clash Display',sans-serif;font-size:22px;font-weight:700;margin-bottom:6px;}
  .form-card .subtitle{color:var(--muted);font-size:14px;margin-bottom:28px;}
  .steps{display:flex;margin-bottom:28px;}
  .step{flex:1;text-align:center;padding:8px 4px;font-size:12px;font-weight:600;color:var(--muted);border-bottom:2px solid var(--border);transition:all 0.3s;}
  .step.active{color:var(--accent);border-bottom-color:var(--accent);}
  .step.done{color:var(--accent2);border-bottom-color:var(--accent2);}
  .form-page{display:none;}
  .form-page.active{display:block;animation:fadeIn 0.3s ease;}
  @keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
  .form-group{margin-bottom:16px;}
  label{display:block;font-size:12px;font-weight:600;color:var(--muted);text-transform:uppercase;letter-spacing:0.8px;margin-bottom:6px;}
  input,select,textarea{width:100%;padding:12px 16px;background:var(--bg);border:1.5px solid var(--border);border-radius:12px;font-size:15px;font-family:'Cabinet Grotesk',sans-serif;color:var(--text);transition:border-color 0.2s;}
  input:focus,select:focus,textarea:focus{outline:none;border-color:var(--accent);background:white;}
  textarea{resize:none;height:80px;}
  .form-row{display:grid;grid-template-columns:1fr 1fr;gap:12px;}
  .commerce-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-bottom:16px;}
  .commerce-item{border:1.5px solid var(--border);border-radius:12px;padding:12px 8px;text-align:center;cursor:pointer;transition:all 0.2s;background:var(--bg);}
  .commerce-item:hover{border-color:var(--accent);background:rgba(232,92,14,0.05);}
  .commerce-item.selected{border-color:var(--accent);background:rgba(232,92,14,0.08);}
  .commerce-item .emoji{font-size:24px;display:block;margin-bottom:4px;}
  .commerce-item .name{font-size:11px;font-weight:600;color:var(--text);}
  .products-list{margin-bottom:12px;}
  .product-item{display:grid;grid-template-columns:1fr auto auto;gap:8px;align-items:center;margin-bottom:8px;}
  .product-item input{padding:10px 12px;font-size:14px;}
  .price-input{width:100px;}
  .remove-product{width:32px;height:32px;border-radius:8px;background:rgba(255,71,87,0.1);color:#ff4757;border:none;cursor:pointer;font-size:16px;display:flex;align-items:center;justify-content:center;flex-shrink:0;}
  .add-product{width:100%;padding:10px;border:1.5px dashed var(--border);border-radius:12px;background:none;cursor:pointer;color:var(--muted);font-size:14px;font-family:'Cabinet Grotesk',sans-serif;transition:all 0.2s;}
  .add-product:hover{border-color:var(--accent);color:var(--accent);}
  .btn-next{width:100%;padding:16px;border-radius:12px;background:var(--accent);color:white;border:none;font-size:16px;font-weight:700;cursor:pointer;font-family:'Cabinet Grotesk',sans-serif;transition:all 0.2s;margin-top:8px;}
  .btn-next:hover{background:#d14e00;transform:translateY(-1px);}
  .btn-next:disabled{background:var(--muted);cursor:not-allowed;transform:none;}
  .btn-back{width:100%;padding:12px;border-radius:12px;background:none;color:var(--muted);border:1.5px solid var(--border);font-size:14px;font-weight:600;cursor:pointer;font-family:'Cabinet Grotesk',sans-serif;margin-top:8px;transition:all 0.2s;}
  .btn-back:hover{border-color:var(--text);color:var(--text);}
  .success-screen{display:none;text-align:center;padding:20px 0;}
  .success-screen.show{display:block;animation:fadeIn 0.5s ease;}
  .success-icon{font-size:64px;margin-bottom:16px;}
  .success-screen h3{font-family:'Clash Display',sans-serif;font-size:24px;font-weight:700;margin-bottom:8px;}
  .success-screen p{color:var(--muted);font-size:15px;line-height:1.6;margin-bottom:24px;}
  .success-info{background:var(--bg);border-radius:12px;padding:20px;text-align:left;margin-bottom:20px;}
  .success-info .row{display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px solid var(--border);font-size:14px;}
  .success-info .row:last-child{border-bottom:none;}
  .success-info .row span:first-child{color:var(--muted);}
  .success-info .row span:last-child{font-weight:600;}
  .whatsapp-btn{display:flex;align-items:center;justify-content:center;gap:10px;width:100%;padding:16px;border-radius:12px;background:var(--accent2);color:white;border:none;font-size:16px;font-weight:700;cursor:pointer;font-family:'Cabinet Grotesk',sans-serif;text-decoration:none;}
  .error-msg{color:#ff4757;font-size:13px;margin-top:8px;display:none;}
  .error-msg.show{display:block;}
  .loading{display:none;align-items:center;justify-content:center;gap:12px;padding:20px;}
  .loading.show{display:flex;}
  .spinner{width:24px;height:24px;border:3px solid var(--border);border-top-color:var(--accent);border-radius:50%;animation:spin 0.8s linear infinite;}
  @keyframes spin{to{transform:rotate(360deg)}}
  @media(max-width:768px){nav{padding:16px 24px;}.container{grid-template-columns:1fr;gap:40px;padding:32px 16px;}.left{display:none;}}
</style>
</head>
<body>
<nav>
  <a href="/" class="logo">Wazi<span>Bot</span></a>
  <span style="font-size:13px;color:var(--muted);">üîí Inscription s√©curis√©e</span>
</nav>
<div class="container">
  <div class="left">
    <div class="badge">üü¢ Essai gratuit ‚Äî 7 jours sans engagement</div>
    <h1>Votre assistant WhatsApp pr√™t en <em>5 minutes</em></h1>
    <p>Remplissez le formulaire et votre bot est op√©rationnel imm√©diatement. Pas besoin de carte bancaire.</p>
    <ul class="benefits">
      <li><div class="icon">ü§ñ</div><div class="text"><strong>Assistant IA configur√© pour vous</strong><span>Personnalit√© adapt√©e √† votre type de commerce</span></div></li>
      <li><div class="icon">üì¶</div><div class="text"><strong>Catalogue import√© automatiquement</strong><span>Ajoutez vos produits directement dans le formulaire</span></div></li>
      <li><div class="icon">üìä</div><div class="text"><strong>Dashboard disponible imm√©diatement</strong><span>G√©rez vos commandes d√®s la premi√®re seconde</span></div></li>
      <li><div class="icon">üí∞</div><div class="text"><strong>7 jours gratuits, puis 15 000 FCFA/mois</strong><span>Paiement MTN ou Moov ‚Äî r√©siliez quand vous voulez</span></div></li>
    </ul>
  </div>
  <div class="form-card">
    <div id="form-content">
      <h2>Cr√©er votre boutique</h2>
      <p class="subtitle">√âtape <span id="step-num">1</span> sur 3 ‚Äî Compl√©tez en moins de 5 minutes</p>
      <div class="steps">
        <div class="step active" id="step-1">üìã Infos</div>
        <div class="step" id="step-2">üè™ Commerce</div>
        <div class="step" id="step-3">üõçÔ∏è Produits</div>
      </div>
      <div class="form-page active" id="page-1">
        <div class="form-group"><label>Nom de votre boutique *</label><input type="text" id="f-name" placeholder="Ex: Boutique Ama, Chez Koffi Mode..." maxlength="60"></div>
        <div class="form-row">
          <div class="form-group"><label>Votre pr√©nom *</label><input type="text" id="f-owner" placeholder="Votre pr√©nom"></div>
          <div class="form-group"><label>Ville *</label><input type="text" id="f-city" placeholder="Lom√©, Kpalim√©..."></div>
        </div>
        <div class="form-group"><label>WhatsApp (pour vous contacter) *</label><input type="tel" id="f-phone" placeholder="+228 XX XX XX XX"></div>
        <div class="form-group"><label>Email</label><input type="email" id="f-email" placeholder="votre@email.com"></div>
        <p class="error-msg" id="err-1">Veuillez remplir tous les champs obligatoires (*).</p>
        <button class="btn-next" onclick="goStep(2)">Continuer ‚Üí</button>
      </div>
      <div class="form-page" id="page-2">
        <div class="form-group">
          <label>Type de commerce *</label>
          <div class="commerce-grid">
            <div class="commerce-item" onclick="selectCommerce('mode',this)"><span class="emoji">üëó</span><span class="name">Mode</span></div>
            <div class="commerce-item" onclick="selectCommerce('food',this)"><span class="emoji">üçΩÔ∏è</span><span class="name">Restauration</span></div>
            <div class="commerce-item" onclick="selectCommerce('tech',this)"><span class="emoji">üì±</span><span class="name">High-Tech</span></div>
            <div class="commerce-item" onclick="selectCommerce('beaute',this)"><span class="emoji">üíÑ</span><span class="name">Beaut√©</span></div>
            <div class="commerce-item" onclick="selectCommerce('epicerie',this)"><span class="emoji">üõí</span><span class="name">√âpicerie</span></div>
            <div class="commerce-item" onclick="selectCommerce('mobilier',this)"><span class="emoji">üõãÔ∏è</span><span class="name">Mobilier</span></div>
            <div class="commerce-item" onclick="selectCommerce('pharmacie',this)"><span class="emoji">üíä</span><span class="name">Pharmacie</span></div>
            <div class="commerce-item" onclick="selectCommerce('batiment',this)"><span class="emoji">üî®</span><span class="name">B√¢timent</span></div>
            <div class="commerce-item" onclick="selectCommerce('general',this)"><span class="emoji">üè™</span><span class="name">Autre</span></div>
          </div>
        </div>
        <div class="form-group"><label>D√©crivez votre boutique (optionnel)</label><textarea id="f-desc" placeholder="Ex: Je vends des v√™tements tendance pour hommes √† Adidogom√©, livraison 24h..."></textarea></div>
        <p class="error-msg" id="err-2">Veuillez choisir un type de commerce.</p>
        <button class="btn-next" onclick="goStep(3)">Continuer ‚Üí</button>
        <button class="btn-back" onclick="goStep(1)">‚Üê Retour</button>
      </div>
      <div class="form-page" id="page-3">
        <label style="display:block;margin-bottom:12px;">Vos produits (ajoutez au moins 1) *</label>
        <div class="products-list" id="products-list">
          <div class="product-item">
            <input type="text" placeholder="Nom du produit" class="product-name">
            <input type="number" placeholder="Prix FCFA" class="price-input product-price">
            <button class="remove-product" onclick="removeProduct(this)" style="display:none">√ó</button>
          </div>
        </div>
        <button class="add-product" onclick="addProduct()">+ Ajouter un produit</button>
        <p class="error-msg" id="err-3">Ajoutez au moins un produit avec nom et prix.</p>
        <div class="loading" id="loading"><div class="spinner"></div><span style="color:var(--muted);font-size:14px;">Cr√©ation de votre boutique...</span></div>
        <button class="btn-next" onclick="submitForm()" id="btn-submit">üöÄ Cr√©er ma boutique gratuite</button>
        <button class="btn-back" onclick="goStep(2)">‚Üê Retour</button>
      </div>
    </div>
    <div class="success-screen" id="success">
      <div class="success-icon">üéâ</div>
      <h3>Votre boutique est pr√™te !</h3>
      <p>Votre assistant WhatsApp est configur√© et op√©rationnel. Vous avez <strong>7 jours gratuits</strong> pour tester.</p>
      <div class="success-info" id="success-info"></div>

      <!-- ID boutique mis en √©vidence -->
      <div style="background:rgba(37,211,102,0.1);border:2px dashed #25D366;border-radius:12px;padding:16px;margin-bottom:16px;text-align:center;">
        <p style="font-size:12px;color:var(--muted);margin-bottom:6px;text-transform:uppercase;letter-spacing:1px;">üîë Votre ID boutique (√† conserver !)</p>
        <p id="merchant-id-display" style="font-size:20px;font-weight:800;color:#25D366;letter-spacing:2px;word-break:break-all;"></p>
        <button onclick="copyId()" style="margin-top:8px;padding:6px 16px;border-radius:8px;background:#25D366;color:white;border:none;cursor:pointer;font-size:13px;font-weight:600;">üìã Copier l'ID</button>
      </div>

      <a href="https://wa.me/22871454079" class="whatsapp-btn" target="_blank" id="whatsapp-contact-btn">üí¨ Recevoir mon ID par WhatsApp</a>
    </div>
  </div>
</div>
<script>
const API = 'https://whatsapp-commerce-1roe.onrender.com';
let selectedCommerce = '';
let currentStep = 1;

function goStep(step) {
  if (step === 2 && currentStep === 1) {
    const name = document.getElementById('f-name').value.trim();
    const owner = document.getElementById('f-owner').value.trim();
    const city = document.getElementById('f-city').value.trim();
    const phone = document.getElementById('f-phone').value.trim();
    if (!name || !owner || !city || !phone) { document.getElementById('err-1').classList.add('show'); return; }
    document.getElementById('err-1').classList.remove('show');
  }
  if (step === 3 && currentStep === 2) {
    if (!selectedCommerce) { document.getElementById('err-2').classList.add('show'); return; }
    document.getElementById('err-2').classList.remove('show');
  }
  document.querySelectorAll('.form-page').forEach(p => p.classList.remove('active'));
  document.getElementById('page-' + step).classList.add('active');
  for (let i = 1; i <= 3; i++) {
    const el = document.getElementById('step-' + i);
    el.classList.remove('active', 'done');
    if (i < step) el.classList.add('done');
    else if (i === step) el.classList.add('active');
  }
  document.getElementById('step-num').textContent = step;
  currentStep = step;
}

function selectCommerce(type, el) {
  document.querySelectorAll('.commerce-item').forEach(i => i.classList.remove('selected'));
  el.classList.add('selected');
  selectedCommerce = type;
}

function addProduct() {
  const list = document.getElementById('products-list');
  const div = document.createElement('div');
  div.className = 'product-item';
  div.innerHTML = '<input type="text" placeholder="Nom du produit" class="product-name"><input type="number" placeholder="Prix FCFA" class="price-input product-price"><button class="remove-product" onclick="removeProduct(this)">√ó</button>';
  list.appendChild(div);
}

function removeProduct(btn) { btn.parentElement.remove(); }

function copyId() {
  const id = document.getElementById("merchant-id-display").textContent;
  navigator.clipboard.writeText(id).then(() => {
    alert("ID copi√© ! Conservez-le pr√©cieusement.");
  });
}

async function submitForm() {
  const products = [];
  document.querySelectorAll('.product-item').forEach(item => {
    const name = item.querySelector('.product-name').value.trim();
    const price = item.querySelector('.product-price').value;
    if (name && price) products.push({ name, price: parseFloat(price), stock: 20 });
  });
  if (products.length === 0) { document.getElementById('err-3').classList.add('show'); return; }
  document.getElementById('err-3').classList.remove('show');
  document.getElementById('loading').classList.add('show');
  document.getElementById('btn-submit').disabled = true;

  const payload = {
    name: document.getElementById('f-name').value.trim(),
    email: document.getElementById('f-email').value.trim(),
    city: document.getElementById('f-city').value.trim(),
    currency: 'FCFA',
    type: selectedCommerce,
    businessDescription: document.getElementById('f-desc').value.trim(),
    products,
  };

  try {
    const res = await fetch(API + '/onboarding/create', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(payload),
    });
    const data = await res.json();
    document.getElementById('loading').classList.remove('show');
    if (data.success) {
      document.getElementById('form-content').style.display = 'none';
      document.getElementById('success').classList.add('show');
      const trialEnd = new Date(data.trialEndsAt).toLocaleDateString('fr-FR');
      const merchantId = data.merchantId;

      document.getElementById('success-info').innerHTML = `
        <div class="row"><span>Boutique</span><span>${payload.name}</span></div>
        <div class="row"><span>Type</span><span>${selectedCommerce}</span></div>
        <div class="row"><span>Produits ajout√©s</span><span>${data.productsCreated}</span></div>
        <div class="row"><span>Essai gratuit jusqu'au</span><span>${trialEnd}</span></div>
        <div class="row"><span>Statut</span><span style="color:#25D366">‚úÖ Actif</span></div>`;

      // Afficher l'ID boutique
      document.getElementById('merchant-id-display').textContent = merchantId;

      // Pr√©parer le message WhatsApp avec l'ID
      const msg = encodeURIComponent(
        `Bonjour WaziBot ! üëã\n\n` +
        `Je viens de cr√©er ma boutique *${payload.name}*.\n` +
        `Mon ID boutique : *${merchantId}*\n\n` +
        `Je voudrais acc√©der √† mon dashboard. Merci !`
      );
      document.getElementById('whatsapp-contact-btn').href = `https://wa.me/22871454079?text=${msg}`;
    } else {
      document.getElementById('btn-submit').disabled = false;
      alert('Erreur : ' + (data.error || 'R√©essayez dans un moment.'));
    }
  } catch (err) {
    document.getElementById('loading').classList.remove('show');
    document.getElementById('btn-submit').disabled = false;
    alert('Erreur de connexion. V√©rifiez votre internet et r√©essayez.');
  }
}
</script>
</body>
</html>
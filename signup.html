<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="shortcut icon" href="/favicon.svg">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DÃ©marrer avec WaziBot â€” Essai gratuit 7 jours</title>
<link href="https://fonts.googleapis.com/css2?family=Clash+Display:wght@600;700&family=Cabinet+Grotesk:wght@300;400;500;700&display=swap" rel="stylesheet">
<style>
  :root { --bg:#f7f3ee;--dark:#1a1208;--accent:#e85c0e;--accent2:#25D366;--text:#2d2010;--muted:#8a7560;--border:#e8ddd0; }
  *{margin:0;padding:0;box-sizing:border-box;}
  body{font-family:'Cabinet Grotesk',sans-serif;background:#ffffff;color:var(--text);min-height:100vh;}
  nav{padding:20px 60px;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid #e0e0ea;background:#ffffff;}
  .logo{font-family:'Clash Display',sans-serif;font-size:22px;font-weight:700;color:var(--dark);text-decoration:none;}
  .logo span{color:var(--accent);}
  .container{max-width:1100px;margin:0 auto;padding:60px 24px;display:grid;grid-template-columns:1fr 1fr;gap:80px;align-items:start;}
  .left .badge{display:inline-flex;align-items:center;gap:8px;background:rgba(37,211,102,0.1);color:var(--accent2);border:1px solid rgba(37,211,102,0.3);padding:6px 14px;border-radius:50px;font-size:13px;font-weight:600;margin-bottom:24px;}
  .left h1{font-family:'Clash Display',sans-serif;font-size:42px;font-weight:700;line-height:1.2;color:var(--dark);margin-bottom:20px;}
  .left h1 em{color:var(--accent);font-style:normal;}
  .left p{color:var(--muted);font-size:16px;line-height:1.7;margin-bottom:36px;}
  .benefits{list-style:none;}
  .benefits li{display:flex;align-items:flex-start;gap:12px;padding:14px 0;border-bottom:1px solid #e0e0ea;font-size:15px;}
  .benefits li:last-child{border-bottom:none;}
  .benefits .icon{width:36px;height:36px;border-radius:10px;background:rgba(232,92,14,0.1);display:flex;align-items:center;justify-content:center;font-size:18px;flex-shrink:0;}
  .benefits .text strong{display:block;font-weight:700;margin-bottom:2px;}
  .benefits .text span{color:var(--muted);font-size:13px;}
  .form-card{background:white;border-radius:24px;padding:40px;border:1px solid var(--border);box-shadow:0 20px 60px rgba(26,18,8,0.08);position:sticky;top:24px;}
  .form-card h2{font-family:'Clash Display',sans-serif;font-size:22px;font-weight:700;margin-bottom:6px;}
  .form-card .subtitle{color:var(--muted);font-size:14px;margin-bottom:28px;}
  .steps{display:flex;margin-bottom:28px;}
  .step{flex:1;text-align:center;padding:8px 4px;font-size:12px;font-weight:600;color:var(--muted);border-bottom:2px solid var(--border);transition:all 0.3s;}
  .step.active{color:var(--accent);border-bottom-color:var(--accent);}
  .step.done{color:var(--accent2);border-bottom-color:var(--accent2);}
  .form-page{display:none;}
  .form-page.active{display:block;animation:fadeIn 0.3s ease;}
  @keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
  .form-group{margin-bottom:16px;}
  label{display:block;font-size:12px;font-weight:600;color:var(--muted);text-transform:uppercase;letter-spacing:0.8px;margin-bottom:6px;}
  input,select,textarea{width:100%;padding:12px 16px;background:#ffffff;border:1.5px solid var(--border);border-radius:12px;font-size:15px;font-family:'Cabinet Grotesk',sans-serif;color:var(--text);transition:border-color 0.2s;}
  input:focus,select:focus,textarea:focus{outline:none;border-color:var(--accent);background:white;}
  textarea{resize:none;height:80px;}
  .form-row{display:grid;grid-template-columns:1fr 1fr;gap:12px;}
  .commerce-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-bottom:16px;}
  .commerce-item{border:1.5px solid var(--border);border-radius:12px;padding:12px 8px;text-align:center;cursor:pointer;transition:all 0.2s;background:#ffffff;}
  .commerce-item:hover{border-color:var(--accent);background:rgba(232,92,14,0.05);}
  .commerce-item.selected{border-color:var(--accent);background:rgba(232,92,14,0.08);}
  .commerce-item .emoji{font-size:24px;display:block;margin-bottom:4px;}
  .commerce-item .name{font-size:11px;font-weight:600;color:var(--text);}
  .products-list{margin-bottom:12px;}
  .product-item{display:grid;grid-template-columns:1fr auto auto;gap:8px;align-items:center;margin-bottom:8px;}
  .product-item input{padding:10px 12px;font-size:14px;}
  .price-input{width:100px;}
  .remove-product{width:32px;height:32px;border-radius:8px;background:rgba(255,71,87,0.1);color:#ff4757;border:none;cursor:pointer;font-size:16px;display:flex;align-items:center;justify-content:center;flex-shrink:0;}
  .add-product{width:100%;padding:10px;border:1.5px dashed var(--border);border-radius:12px;background:none;cursor:pointer;color:var(--muted);font-size:14px;font-family:'Cabinet Grotesk',sans-serif;transition:all 0.2s;}
  .add-product:hover{border-color:var(--accent);color:var(--accent);}
  .btn-next{width:100%;padding:16px;border-radius:12px;background:var(--accent);color:white;border:none;font-size:16px;font-weight:700;cursor:pointer;font-family:'Cabinet Grotesk',sans-serif;transition:all 0.2s;margin-top:8px;}
  .btn-next:hover{background:#d14e00;transform:translateY(-1px);}
  .btn-next:disabled{background:var(--muted);cursor:not-allowed;transform:none;}
  .btn-back{width:100%;padding:12px;border-radius:12px;background:none;color:var(--muted);border:1.5px solid var(--border);font-size:14px;font-weight:600;cursor:pointer;font-family:'Cabinet Grotesk',sans-serif;margin-top:8px;transition:all 0.2s;}
  .btn-back:hover{border-color:var(--text);color:var(--text);}
  .success-screen{display:none;text-align:center;padding:20px 0;}
  .success-screen.show{display:block;animation:fadeIn 0.5s ease;}
  .success-icon{font-size:64px;margin-bottom:16px;}
  .success-screen h3{font-family:'Clash Display',sans-serif;font-size:24px;font-weight:700;margin-bottom:8px;}
  .success-screen p{color:var(--muted);font-size:15px;line-height:1.6;margin-bottom:24px;}
  .success-info{background:#ffffff;border-radius:12px;padding:20px;text-align:left;margin-bottom:20px;}
  .success-info .row{display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px solid #e0e0ea;font-size:14px;}
  .success-info .row:last-child{border-bottom:none;}
  .success-info .row span:first-child{color:var(--muted);}
  .success-info .row span:last-child{font-weight:600;}
  .whatsapp-btn{display:flex;align-items:center;justify-content:center;gap:10px;width:100%;padding:16px;border-radius:12px;background:var(--accent2);color:#0a0a14;border:none;font-size:16px;font-weight:700;cursor:pointer;font-family:'Cabinet Grotesk',sans-serif;text-decoration:none;}
  .error-msg{color:#ff4757;font-size:13px;margin-top:8px;display:none;}
  .error-msg.show{display:block;}
  .loading{display:none;align-items:center;justify-content:center;gap:12px;padding:20px;}
  .loading.show{display:flex;}
  .spinner{width:24px;height:24px;border:3px solid var(--border);border-top-color:var(--accent);border-radius:50%;animation:spin 0.8s linear infinite;}
  @keyframes spin{to{transform:rotate(360deg)}}
  @media(max-width:768px){nav{padding:16px 24px;}.container{grid-template-columns:1fr;gap:40px;padding:32px 16px;}.left{display:none;}}
</style>
</head>
<body>
<nav>
  <a href="/" class="logo">Wazi<span>Bot</span></a>
  <span style="font-size:13px;color:var(--muted);">ğŸ”’ Inscription sÃ©curisÃ©e</span>
</nav>
<div class="container">
  <div class="left">
    <div class="badge">ğŸŸ¢ Essai gratuit â€” 7 jours sans engagement</div>
    <h1>Votre assistant WhatsApp prÃªt en <em>5 minutes</em></h1>
    <p>Remplissez le formulaire et votre bot est opÃ©rationnel immÃ©diatement. Pas besoin de carte bancaire.</p>
    <ul class="benefits">
      <li><div class="icon">ğŸ¤–</div><div class="text"><strong>Assistant IA configurÃ© pour vous</strong><span>PersonnalitÃ© adaptÃ©e Ã  votre type de commerce</span></div></li>
      <li><div class="icon">ğŸ“¦</div><div class="text"><strong>Catalogue importÃ© automatiquement</strong><span>Ajoutez vos produits directement dans le formulaire</span></div></li>
      <li><div class="icon">ğŸ“Š</div><div class="text"><strong>Dashboard disponible immÃ©diatement</strong><span>GÃ©rez vos commandes dÃ¨s la premiÃ¨re seconde</span></div></li>
      <li><div class="icon">ğŸ’°</div><div class="text"><strong>7 jours gratuits, puis abonnement mensuel</strong><span>Paiement via Mobile Money â€” rÃ©siliez quand vous voulez</span></div></li>
    </ul>
  </div>
  <div class="form-card">
    <div id="form-content">
      <h2>CrÃ©er votre boutique</h2>
      <p class="subtitle">Ã‰tape <span id="step-num">1</span> sur 3 â€” ComplÃ©tez en moins de 5 minutes</p>
      <div class="steps">
        <div class="step active" id="step-1">ğŸ“‹ Infos</div>
        <div class="step" id="step-2">ğŸª Commerce</div>
        <div class="step" id="step-3">ğŸ›ï¸ Produits</div>
      </div>
      <div class="form-page active" id="page-1">
        <div class="form-group"><label>Nom de votre boutique *</label><input type="text" id="f-name" placeholder="Ex: Boutique Ama, Chez Koffi Mode..." maxlength="60"></div>
        <div class="form-row">
          <div class="form-group"><label>Votre prÃ©nom *</label><input type="text" id="f-owner" placeholder="Votre prÃ©nom"></div>
          <div class="form-group"><label>Ville *</label><input type="text" id="f-city" placeholder="Votre ville..."></div>
        </div>
        <div class="form-group">
          <label>Pays *</label>
                    <select id="f-country" onchange="updateCountry()" style="width:100%;background:#ffffff;border:1.5px solid var(--border);padding:12px 14px;border-radius:10px;font-size:15px;color:var(--text);font-family:'Cabinet Grotesk',sans-serif;">
            <option value="">â€” SÃ©lectionnez votre pays â€”</option>
            <option value="BJ|+229|XOF">ğŸ‡§ğŸ‡¯ BÃ©nin (+229)</option>
            <option value="BF|+226|XOF">ğŸ‡§ğŸ‡« Burkina Faso (+226)</option>
            <option value="CM|+237|XAF">ğŸ‡¨ğŸ‡² Cameroun (+237)</option>
            <option value="CI|+225|XOF">ğŸ‡¨ğŸ‡® CÃ´te d'Ivoire (+225)</option>
            <option value="GA|+241|XAF">ğŸ‡¬ğŸ‡¦ Gabon (+241)</option>
            <option value="GN|+224|GNF">ğŸ‡¬ğŸ‡³ GuinÃ©e (+224)</option>
            <option value="KE|+254|KES">ğŸ‡°ğŸ‡ª Kenya (+254)</option>
            <option value="ML|+223|XOF">ğŸ‡²ğŸ‡± Mali (+223)</option>
            <option value="MR|+222|MRO">ğŸ‡²ğŸ‡· Mauritanie (+222)</option>
            <option value="NG|+234|NGN">ğŸ‡³ğŸ‡¬ Nigeria (+234)</option>
            <option value="RW|+250|RWF">ğŸ‡·ğŸ‡¼ Rwanda (+250)</option>
            <option value="SN|+221|XOF">ğŸ‡¸ğŸ‡³ SÃ©nÃ©gal (+221)</option>
            <option value="TD|+235|XAF">ğŸ‡¹ğŸ‡© Tchad (+235)</option>
            <option value="TG|+228|XOF">ğŸ‡¹ğŸ‡¬ Togo (+228)</option>
            <option value="TZ|+255|TZS">ğŸ‡¹ğŸ‡¿ Tanzanie (+255)</option>
            <option value="UG|+256|UGX">ğŸ‡ºğŸ‡¬ Ouganda (+256)</option>
          </select>
        </div>
        <div id="local-prices" style="display:none;background:rgba(232,92,14,0.08);border:1px solid rgba(232,92,14,0.2);border-radius:10px;padding:12px 16px;font-size:13px;color:var(--text);margin-top:-8px;line-height:1.6;"></div>
        <div class="form-group">
          <label>WhatsApp (pour vous contacter) *</label>
          <div style="display:flex;gap:8px;">
            <div id="indicatif-badge" style="background:#ffffff;border:1.5px solid var(--border);padding:12px 14px;border-radius:10px;font-size:15px;color:var(--muted);white-space:nowrap;min-width:80px;text-align:center;">+XXX</div>
            <input type="tel" id="f-phone" placeholder="XX XX XX XX" style="flex:1;">
          </div>
        </div>
        <div class="form-group"><label>Email</label><input type="email" id="f-email" placeholder="votre@email.com"></div>
        <p class="error-msg" id="err-1">Veuillez remplir tous les champs obligatoires (*).</p>
        <button class="btn-next" onclick="goStep(2)">Continuer â†’</button>
      </div>
      <div class="form-page" id="page-2">
        <div class="form-group">
          <label>Type de commerce *</label>
          <div class="commerce-grid">
            <div class="commerce-item" onclick="selectCommerce('mode',this)"><span class="emoji">ğŸ‘—</span><span class="name">Mode</span></div>
            <div class="commerce-item" onclick="selectCommerce('food',this)"><span class="emoji">ğŸ½ï¸</span><span class="name">Restauration</span></div>
            <div class="commerce-item" onclick="selectCommerce('tech',this)"><span class="emoji">ğŸ“±</span><span class="name">High-Tech</span></div>
            <div class="commerce-item" onclick="selectCommerce('beaute',this)"><span class="emoji">ğŸ’„</span><span class="name">BeautÃ©</span></div>
            <div class="commerce-item" onclick="selectCommerce('epicerie',this)"><span class="emoji">ğŸ›’</span><span class="name">Ã‰picerie</span></div>
            <div class="commerce-item" onclick="selectCommerce('mobilier',this)"><span class="emoji">ğŸ›‹ï¸</span><span class="name">Mobilier</span></div>
            <div class="commerce-item" onclick="selectCommerce('pharmacie',this)"><span class="emoji">ğŸ’Š</span><span class="name">Pharmacie</span></div>
            <div class="commerce-item" onclick="selectCommerce('batiment',this)"><span class="emoji">ğŸ”¨</span><span class="name">BÃ¢timent</span></div>
            <div class="commerce-item" onclick="selectCommerce('general',this)"><span class="emoji">ğŸª</span><span class="name">Autre</span></div>
          </div>
        </div>
        <div class="form-group"><label>DÃ©crivez votre boutique (optionnel)</label><textarea id="f-desc" placeholder="Ex: Je vends des vÃªtements tendance pour hommes Ã  AdidogomÃ©, livraison 24h..."></textarea></div>
        <p class="error-msg" id="err-2">Veuillez choisir un type de commerce.</p>
        <button class="btn-next" onclick="goStep(3)">Continuer â†’</button>
        <button class="btn-back" onclick="goStep(1)">â† Retour</button>
      </div>
      <div class="form-page" id="page-3">
        <label style="display:block;margin-bottom:12px;">Vos produits (ajoutez au moins 1) *</label>
        <div class="products-list" id="products-list">
          <div class="product-item">
            <input type="text" placeholder="Nom du produit" class="product-name">
            <input type="number" placeholder="Prix" class="price-input product-price">
            <button class="remove-product" onclick="removeProduct(this)" style="display:none">Ã—</button>
          </div>
        </div>
        <button class="add-product" onclick="addProduct()">+ Ajouter un produit</button>
        <p class="error-msg" id="err-3">Ajoutez au moins un produit avec nom et prix.</p>
        <div class="loading" id="loading"><div class="spinner"></div><span style="color:var(--muted);font-size:14px;">CrÃ©ation de votre boutique...</span></div>
        <button class="btn-next" onclick="submitForm()" id="btn-submit">ğŸš€ CrÃ©er ma boutique gratuite</button>
        <button class="btn-back" onclick="goStep(2)">â† Retour</button>
      </div>
    </div>
    <div class="success-screen" id="success">
      <div class="success-icon">ğŸ‰</div>
      <h3>Votre boutique est prÃªte !</h3>
      <p>Votre assistant WhatsApp est configurÃ© et opÃ©rationnel. Vous avez <strong>7 jours gratuits</strong> pour tester.</p>
      <div class="success-info" id="success-info"></div>

      <!-- ID boutique mis en Ã©vidence -->
      <div style="background:rgba(37,211,102,0.1);border:2px dashed #25D366;border-radius:12px;padding:16px;margin-bottom:16px;text-align:center;">
        <p style="font-size:12px;color:var(--muted);margin-bottom:6px;text-transform:uppercase;letter-spacing:1px;">ğŸ”‘ Votre ID boutique (Ã  conserver !)</p>
        <p id="merchant-id-display" style="font-size:20px;font-weight:800;color:#25D366;letter-spacing:2px;word-break:break-all;"></p>
        <button onclick="copyId()" style="margin-top:8px;padding:6px 16px;border-radius:8px;background:#25D366;color:white;border:none;cursor:pointer;font-size:13px;font-weight:600;">ğŸ“‹ Copier l'ID</button>
      </div>

      <a href="#" class="whatsapp-btn" id="dashboard-btn" style="background:var(--accent2);" onclick="goToDashboard(event)">ğŸ“Š AccÃ©der Ã  mon dashboard â†’</a>
    </div>
  </div>
</div>
<script>
const API = 'https://whatsapp-commerce-1roe.onrender.com';
let selectedCommerce = '';
let currentStep = 1;

function goStep(step) {
  if (step === 2 && currentStep === 1) {
    const name = document.getElementById('f-name').value.trim();
    const owner = document.getElementById('f-owner').value.trim();
    const city = document.getElementById('f-city').value.trim();
    const phone = document.getElementById('f-phone').value.trim();
    const country = document.getElementById('f-country').value;
    if (!name || !owner || !city || !phone || !country) { document.getElementById('err-1').classList.add('show'); return; }
    document.getElementById('err-1').classList.remove('show');
  }
  if (step === 3 && currentStep === 2) {
    if (!selectedCommerce) { document.getElementById('err-2').classList.add('show'); return; }
    document.getElementById('err-2').classList.remove('show');
  }
  document.querySelectorAll('.form-page').forEach(p => p.classList.remove('active'));
  document.getElementById('page-' + step).classList.add('active');
  for (let i = 1; i <= 3; i++) {
    const el = document.getElementById('step-' + i);
    el.classList.remove('active', 'done');
    if (i < step) el.classList.add('done');
    else if (i === step) el.classList.add('active');
  }
  document.getElementById('step-num').textContent = step;
  currentStep = step;
}

function selectCommerce(type, el) {
  document.querySelectorAll('.commerce-item').forEach(i => i.classList.remove('selected'));
  el.classList.add('selected');
  selectedCommerce = type;
}

function addProduct() {
  const list = document.getElementById('products-list');
  const div = document.createElement('div');
  div.className = 'product-item';
  div.innerHTML = '<input type="text" placeholder="Nom du produit" class="product-name"><input type="number" placeholder="Prix" class="price-input product-price"><button class="remove-product" onclick="removeProduct(this)">Ã—</button>';
  list.appendChild(div);
}

function removeProduct(btn) { btn.parentElement.remove(); }

// Prix par pays (Starter / Pro / Business)
const COUNTRY_PRICES = {
  BJ: { currency: 'XOF', starter: '20 000', pro: '40 000', business: '100 000' },
  BF: { currency: 'XOF', starter: '20 000', pro: '40 000', business: '100 000' },
  CM: { currency: 'XAF', starter: '20 000', pro: '40 000', business: '100 000' },
  CI: { currency: 'XOF', starter: '20 000', pro: '40 000', business: '100 000' },
  GA: { currency: 'XAF', starter: '20 000', pro: '40 000', business: '100 000' },
  GN: { currency: 'GNF', starter: '250 000', pro: '500 000', business: '1 250 000' },
  KE: { currency: 'KES', starter: '3 500', pro: '7 000', business: '18 000' },
  ML: { currency: 'XOF', starter: '20 000', pro: '40 000', business: '100 000' },
  MR: { currency: 'MRO', starter: '11 000', pro: '22 000', business: '55 000' },
  NG: { currency: 'NGN', starter: '50 000', pro: '100 000', business: '250 000' },
  RW: { currency: 'RWF', starter: '34 000', pro: '68 000', business: '170 000' },
  SN: { currency: 'XOF', starter: '20 000', pro: '40 000', business: '100 000' },
  TD: { currency: 'XAF', starter: '20 000', pro: '40 000', business: '100 000' },
  TG: { currency: 'XOF', starter: '20 000', pro: '40 000', business: '100 000' },
  TZ: { currency: 'TZS', starter: '75 000', pro: '150 000', business: '380 000' },
  UG: { currency: 'UGX', starter: '110 000', pro: '220 000', business: '550 000' },
};

function updateCountry() {
  const select = document.getElementById('f-country');
  const val = select.value; // format: "CODE|+indicatif|DEVISE"
  if (!val) return;
  const parts = val.split('|');
  window.selectedCountry = parts[0];
  window.selectedIndicatif = parts[1];
  window.selectedCurrency = parts[2];
  document.getElementById('indicatif-badge').textContent = parts[1];
  document.getElementById('indicatif-badge').style.color = 'var(--accent)';
  document.getElementById('indicatif-badge').style.borderColor = 'var(--accent)';

  // Afficher les prix locaux
  const prices = COUNTRY_PRICES[parts[0]];
  if (prices) {
    const priceEl = document.getElementById('local-prices');
    if (priceEl) {
      priceEl.innerHTML = 
        '<strong>ğŸ’° Vos tarifs :</strong> ' +
        'Starter <strong>' + prices.starter + ' ' + prices.currency + '</strong>/mois â€” ' +
        'Pro <strong>' + prices.pro + ' ' + prices.currency + '</strong>/mois â€” ' +
        'Business <strong>' + prices.business + ' ' + prices.currency + '</strong>/mois';
      priceEl.style.display = 'block';
    }
    window.selectedCurrency = prices.currency;
  }
}

function goToDashboard(e) {
  e.preventDefault();
  const id = document.getElementById('merchant-id-display').textContent;
  window.location.href = 'https://whatsapp-commerce-1roe.onrender.com/dashboard?id=' + id;
}

function copyId() {
  const id = document.getElementById("merchant-id-display").textContent;
  navigator.clipboard.writeText(id).then(() => {
    alert("ID copiÃ© ! Conservez-le prÃ©cieusement.");
  });
}

async function submitForm() {
  const products = [];
  document.querySelectorAll('.product-item').forEach(item => {
    const name = item.querySelector('.product-name').value.trim();
    const price = item.querySelector('.product-price').value;
    if (name && price) products.push({ name, price: parseFloat(price), stock: 20 });
  });
  if (products.length === 0) { document.getElementById('err-3').classList.add('show'); return; }
  document.getElementById('err-3').classList.remove('show');
  document.getElementById('loading').classList.add('show');
  document.getElementById('btn-submit').disabled = true;

  const payload = {
    name: document.getElementById('f-name').value.trim(),
    email: document.getElementById('f-email').value.trim(),
    city: document.getElementById('f-city').value.trim(),
    currency: window.selectedCurrency || 'USD',
    country: window.selectedCountry || '',
    ownerPhone: (window.selectedIndicatif || '') + document.getElementById('f-phone').value.trim().replace(/\s/g, ''),
    type: selectedCommerce,
    businessDescription: document.getElementById('f-desc').value.trim(),
    products,
  };

  try {
    const res = await fetch(API + '/onboarding/create', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(payload),
    });

    // CommerÃ§ant dÃ©jÃ  inscrit
    if (res.status === 409) {
      const data = await res.json();
      document.getElementById('loading').classList.remove('show');
      document.getElementById('btn-submit').disabled = false;
      document.getElementById('err-3').textContent = "Ce numÃ©ro ou email est dÃ©jÃ  inscrit. AccÃ©dez Ã  votre dashboard existant.";
      document.getElementById('err-3').classList.add('show');
      document.getElementById('err-3').style.cursor = 'pointer';
      document.getElementById('err-3').onclick = () => window.location.href = data.dashboardUrl;
      return;
    }
    const data = await res.json();
    document.getElementById('loading').classList.remove('show');
    if (data.success) {
      document.getElementById('form-content').style.display = 'none';
      document.getElementById('success').classList.add('show');
      const trialEnd = new Date(data.trialEndsAt).toLocaleDateString('fr-FR');
      const merchantId = data.merchantId;

      document.getElementById('success-info').innerHTML = `
        <div class="row"><span>Boutique</span><span>${payload.name}</span></div>
        <div class="row"><span>Type</span><span>${selectedCommerce}</span></div>
        <div class="row"><span>Produits ajoutÃ©s</span><span>${data.productsCreated}</span></div>
        <div class="row"><span>Essai gratuit jusqu'au</span><span>${trialEnd}</span></div>
        <div class="row"><span>Statut</span><span style="color:#25D366">âœ… Actif</span></div>`;

      // Afficher l'ID boutique
      document.getElementById('merchant-id-display').textContent = merchantId;

      // PrÃ©parer le message WhatsApp avec l'ID
      const msg = encodeURIComponent(
        `Bonjour WaziBot ! ğŸ‘‹\n\n` +
        `Je viens de crÃ©er ma boutique *${payload.name}*.\n` +
        `Mon ID boutique : *${merchantId}*\n\n` +
        `Je voudrais accÃ©der Ã  mon dashboard. Merci !`
      );
      // Dashboard button prÃªt
    } else {
      document.getElementById('btn-submit').disabled = false;
      alert('Erreur : ' + (data.error || 'RÃ©essayez dans un moment.'));
    }
  } catch (err) {
    document.getElementById('loading').classList.remove('show');
    document.getElementById('btn-submit').disabled = false;
    alert('Erreur de connexion. VÃ©rifiez votre internet et rÃ©essayez.');
  }
}
</script>
</body>
</html>